<!DOCTYPE html>
<html lang="do">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OfiStock - Gestión de Inventario</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, addDoc, updateDoc, deleteDoc, onSnapshot, query } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

        // --- Configuración y Variables Globales ---
        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'inventario-oficina-pro';
        
        const RECIPIENT_EMAIL = "soporte@harryheinsen.com";
        const ADMIN_PASSWORD = "admin123";

        // Estado de la Aplicación
        let state = {
            user: null,
            view: 'employee', // 'employee' | 'admin'
            adminTab: 'inventory', // 'inventory' | 'requests'
            isAdminAuthenticated: false,
            inventory: [],
            requests: [],
            cart: [],
            employeeName: '',
            department: '',
            isLoading: true,
            isSubmitting: false,
            editingProduct: null
        };

        // --- Utilidades de Interfaz ---
        const notify = (message, type = 'success') => {
            const toast = document.getElementById('notification');
            toast.textContent = message;
            toast.className = `fixed bottom-12 right-12 z-[60] flex items-center gap-5 px-10 py-6 rounded-[2.5rem] shadow-2xl transition-all duration-300 text-white font-black ${type === 'error' ? 'bg-red-500 shadow-red-100' : 'bg-slate-900 border border-slate-800 shadow-slate-200'}`;
            toast.classList.remove('hidden', 'opacity-0', 'translate-y-10');
            
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-10');
                setTimeout(() => toast.classList.add('hidden'), 300);
            }, 3000);
        };

        // --- Lógica de Negocio ---
        const addToCart = (productId) => {
            const item = state.inventory.find(i => i.id === productId);
            if (!item || item.stock <= 0) {
                notify("Insumo agotado", "error");
                return;
            }

            const existing = state.cart.find(c => c.id === productId);
            if (existing) {
                if (existing.quantity < item.stock) {
                    existing.quantity++;
                } else {
                    notify("Stock máximo alcanzado en carrito", "error");
                }
            } else {
                state.cart.push({ ...item, quantity: 1 });
            }
            render();
        };

        const updateCartQuantity = (productId, delta) => {
            const item = state.cart.find(c => c.id === productId);
            const invItem = state.inventory.find(i => i.id === productId);
            if (item) {
                const newQty = item.quantity + delta;
                if (newQty > 0 && newQty <= invItem.stock) {
                    item.quantity = newQty;
                } else if (newQty <= 0) {
                    state.cart = state.cart.filter(c => c.id !== productId);
                }
            }
            render();
        };

        const submitRequest = async () => {
            const nameInput = document.getElementById('employeeName');
            const deptSelect = document.getElementById('departmentSelect');
            
            if (!state.user || !nameInput.value || !deptSelect.value || state.cart.length === 0) {
                notify("Complete todos los campos del formulario", "error");
                return;
            }

            state.isSubmitting = true;
            render();

            try {
                const requestData = {
                    timestamp: Date.now(),
                    date: new Date().toLocaleString(),
                    employee: nameInput.value,
                    department: deptSelect.value,
                    items: state.cart.map(i => ({ id: i.id, name: i.name, quantity: i.quantity, unit: i.unit })),
                    status: 'Pendiente',
                    userId: state.user.uid
                };
                
                const requestsCol = collection(db, 'artifacts', appId, 'public', 'data', 'requests');
                await addDoc(requestsCol, requestData);

                // Actualizar stock de forma atómica
                for (const cartItem of state.cart) {
                    const itemRef = doc(db, 'artifacts', appId, 'public', 'data', 'inventory', cartItem.id);
                    const currentInv = state.inventory.find(i => i.id === cartItem.id);
                    await updateDoc(itemRef, {
                        stock: Math.max(0, currentInv.stock - cartItem.quantity)
                    });
                }

                // Generar Link Correo
                const subject = encodeURIComponent(`SOLICITUD DE MATERIALES: ${requestData.employee}`);
                const body = encodeURIComponent(
                    `REPORTE DE SOLICITUD INTERNA\n==============================\n\n` +
                    `Solicitante: ${requestData.employee}\nDepartamento: ${requestData.department}\nFecha: ${requestData.date}\n\n` +
                    `MATERIALES:\n` + requestData.items.map(i => `• ${i.name}: ${i.quantity} ${i.unit || 'uds.'}`).join('\n') +
                    `\n\n==============================\nReporte generado desde OfiStock.`
                );
                window.location.href = `mailto:${RECIPIENT_EMAIL}?subject=${subject}&body=${body}`;

                state.cart = [];
                nameInput.value = "";
                deptSelect.value = "";
                notify("Solicitud procesada correctamente.");
            } catch (error) {
                notify("Error al guardar en base de datos", "error");
            } finally {
                state.isSubmitting = false;
                render();
            }
        };

        const handleSaveProduct = async (e) => {
            e.preventDefault();
            const form = e.target;
            const productData = {
                name: form.name.value,
                category: form.category.value,
                stock: parseInt(form.stock.value),
                unit: form.unit.value
            };

            try {
                const invCol = collection(db, 'artifacts', appId, 'public', 'data', 'inventory');
                if (state.editingProduct) {
                    await setDoc(doc(invCol, state.editingProduct.id), productData, { merge: true });
                } else {
                    await addDoc(invCol, productData);
                }
                closeModal();
                notify("Sincronización exitosa");
            } catch (error) {
                notify("Error al guardar producto", "error");
            }
        };

        const handleDeleteProduct = async (id) => {
            if (!confirm("¿Eliminar este insumo permanentemente?")) return;
            try {
                await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'inventory', id));
                notify("Producto eliminado");
            } catch (error) {
                notify("Error al eliminar", "error");
            }
        };

        const updateRequestStatus = async (id, status) => {
            try {
                await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'requests', id), { status });
                notify(`Estado: ${status}`);
            } catch (error) {
                notify("Error al actualizar", "error");
            }
        };

        const closeModal = () => {
            state.editingProduct = null;
            document.getElementById('modal').classList.add('hidden');
        };

        const openModal = (product = null) => {
            state.editingProduct = product;
            const modal = document.getElementById('modal');
            const form = document.getElementById('productForm');
            
            form.name.value = product?.name || '';
            form.category.value = product?.category || '';
            form.stock.value = product?.stock || '';
            form.unit.value = product?.unit || '';
            
            document.getElementById('modalTitle').textContent = product ? 'Modificar Insumo' : 'Nuevo Insumo';
            modal.classList.remove('hidden');
        };

        // --- Renderizado UI ---
        const render = () => {
            const root = document.getElementById('app-content');
            
            if (state.isLoading) {
                root.innerHTML = `<div class="h-96 flex flex-col items-center justify-center gap-4 text-slate-400">
                    <i data-lucide="loader-2" class="animate-spin text-blue-600 w-12 h-12"></i>
                    <span class="font-black uppercase tracking-widest text-xs">Cargando Cloud Data...</span>
                </div>`;
                lucide.createIcons();
                return;
            }

            if (state.view === 'employee') {
                renderEmployeeView(root);
            } else {
                renderAdminView(root);
            }
            lucide.createIcons();
        };

        const renderEmployeeView = (container) => {
            container.innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500">
                    <div class="lg:col-span-2 space-y-4">
                        <header class="mb-6">
                            <h1 class="text-4xl font-black tracking-tighter text-slate-800">Solicitar Insumos</h1>
                            <p class="text-slate-500 mt-2">Los pedidos se envían a <span class="font-bold text-blue-600 underline">${RECIPIENT_EMAIL}</span></p>
                        </header>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${state.inventory.map(item => `
                                <div class="bg-white p-6 rounded-[2rem] border border-slate-200 shadow-sm hover:shadow-xl transition-all group">
                                    <div class="flex justify-between items-start mb-6">
                                        <div class="flex-1">
                                            <h3 class="font-bold text-slate-800 text-lg group-hover:text-blue-600 transition-colors">${item.name}</h3>
                                            <p class="text-[10px] text-slate-400 uppercase font-black tracking-widest mt-1">${item.category}</p>
                                        </div>
                                        <div class="px-3 py-1.5 rounded-2xl text-[10px] font-black uppercase tracking-tighter ml-2 bg-${item.stock > 10 ? 'green' : 'red'}-50 text-${item.stock > 10 ? 'green' : 'red'}-600">
                                            Stock: ${item.stock} ${item.unit}
                                        </div>
                                    </div>
                                    <button onclick="window.addToCart('${item.id}')" ${item.stock === 0 ? 'disabled' : ''} class="w-full bg-blue-600 text-white py-3.5 rounded-2xl font-black hover:bg-blue-700 disabled:bg-slate-100 disabled:text-slate-300 flex items-center justify-center gap-2">
                                        <i data-lucide="plus" class="w-5 h-5"></i> Añadir
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="bg-white p-8 rounded-[2.5rem] border border-slate-200 h-fit sticky top-24 shadow-2xl border-t-[12px] border-t-blue-600">
                        <h2 class="text-2xl font-black mb-8 flex items-center gap-3 tracking-tighter"><i data-lucide="shopping-cart" class="text-blue-600"></i> Mi Solicitud</h2>
                        <div class="space-y-5 mb-8">
                            <div class="space-y-1">
                                <label class="text-[10px] font-black uppercase text-slate-400 ml-2 tracking-widest">Nombre Completo</label>
                                <input id="employeeName" value="${state.employeeName}" placeholder="Ej: Juan Pérez" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-4 focus:ring-blue-50 font-bold" />
                            </div>
                            <div class="space-y-1">
                                <label class="text-[10px] font-black uppercase text-slate-400 ml-2 tracking-widest">Departamento</label>
                                <select id="departmentSelect" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-4 focus:ring-blue-50 font-bold">
                                    <option value="">Seleccionar...</option>
                                    <option value="Administración">Administración</option>
                                    <option value="Almacén">Almacén</option>
                                    <option value="Cobros">Cobros</option>
                                    <option value="Contabilidad">Contabilidad</option>
                                    <option value="Operaciones">Operaciones</option>
                                    <option value="Recepción">Recepción</option>
                                    <option value="Tecnología">Tecnología</option>
                                    <option value="Trafico">Trafico</option>
                                    <option value="Ventas">Ventas</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="divide-y divide-slate-100 max-h-72 overflow-y-auto pr-2">
                            ${state.cart.length === 0 ? `
                                <div class="text-center py-12 flex flex-col items-center gap-3 grayscale opacity-30">
                                    <i data-lucide="package" class="w-12 h-12"></i>
                                    <p class="text-xs font-black uppercase tracking-widest">Carrito Vacío</p>
                                </div>
                            ` : state.cart.map(item => `
                                <div class="py-5 flex justify-between items-center">
                                    <div class="flex-1 pr-2">
                                        <p class="font-black text-slate-800 text-sm leading-tight">${item.name}</p>
                                        <div class="flex items-center gap-4 mt-3">
                                            <button onclick="window.updateCartQuantity('${item.id}', -1)" class="w-8 h-8 flex items-center justify-center rounded-xl bg-slate-100 hover:bg-slate-200 text-slate-600 shadow-sm transition-all active:scale-90"><i data-lucide="minus" class="w-3.5 h-3.5"></i></button>
                                            <span class="font-black text-blue-600 text-lg">${item.quantity}</span>
                                            <button onclick="window.updateCartQuantity('${item.id}', 1)" class="w-8 h-8 flex items-center justify-center rounded-xl bg-slate-100 hover:bg-slate-200 text-slate-600 shadow-sm transition-all active:scale-90"><i data-lucide="plus" class="w-3.5 h-3.5"></i></button>
                                        </div>
                                    </div>
                                    <button onclick="window.updateCartQuantity('${item.id}', -${item.quantity})" class="text-red-300 hover:text-red-500 hover:bg-red-50 p-3 rounded-2xl transition-all"><i data-lucide="trash-2" class="w-5 h-5"></i></button>
                                </div>
                            `).join('')}
                        </div>

                        ${state.cart.length > 0 ? `
                            <button onclick="window.submitRequest()" ${state.isSubmitting ? 'disabled' : ''} class="w-full mt-10 bg-green-600 text-white py-5 rounded-3xl font-black hover:bg-green-700 shadow-2xl shadow-green-100 flex items-center justify-center gap-3 transition-all active:scale-95">
                                ${state.isSubmitting ? '<i data-lucide="loader-2" class="animate-spin w-6 h-6"></i>' : '<i data-lucide="send" class="w-6 h-6"></i>'}
                                Confirmar y Enviar
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
            if(state.department) document.getElementById('departmentSelect').value = state.department;
        };

        const renderAdminView = (container) => {
            if (!state.isAdminAuthenticated) {
                container.innerHTML = `
                    <div class="max-w-md mx-auto mt-20 bg-white p-12 rounded-[3.5rem] border border-slate-200 shadow-2xl text-center">
                        <div class="w-24 h-24 bg-indigo-50 text-indigo-600 rounded-[2.5rem] flex items-center justify-center mx-auto mb-10 shadow-inner"><i data-lucide="lock" class="w-11 h-11"></i></div>
                        <h2 class="text-3xl font-black mb-4 tracking-tighter text-slate-800">Panel Maestro</h2>
                        <form id="adminLoginForm" class="space-y-6">
                            <input type="password" id="adminPwd" class="w-full p-5 bg-slate-50 border-2 border-slate-100 rounded-3xl outline-none focus:border-indigo-500 text-center text-3xl font-bold tracking-[0.5em]" placeholder="••••" />
                            <button type="submit" class="w-full bg-indigo-600 text-white py-5 rounded-[2rem] font-black hover:bg-indigo-700 shadow-2xl shadow-indigo-100 text-lg transition-all active:scale-95">Entrar al Sistema</button>
                        </form>
                    </div>
                `;
                document.getElementById('adminLoginForm').onsubmit = window.handleAdminLogin;
                return;
            }

            container.innerHTML = `
                <div class="space-y-8 animate-in fade-in duration-500">
                    <header class="flex flex-wrap justify-between items-end gap-6 border-b border-slate-200 pb-8">
                        <div>
                            <h1 class="text-4xl font-black tracking-tighter text-slate-800">Administración Cloud</h1>
                            <p class="text-slate-500 font-medium mt-1 italic">Gestión de insumos en tiempo real.</p>
                        </div>
                        <div class="flex gap-4 items-center">
                            <div class="flex bg-slate-100 p-1.5 rounded-[1.5rem] border border-slate-200 shadow-inner">
                                <button onclick="window.setAdminTab('inventory')" class="px-5 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all ${state.adminTab === 'inventory' ? 'bg-white shadow-sm text-indigo-600' : 'text-slate-400'}"><i data-lucide="layers" class="w-3.5 h-3.5"></i> Inventario</button>
                                <button onclick="window.setAdminTab('requests')" class="px-5 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all ${state.adminTab === 'requests' ? 'bg-white shadow-sm text-indigo-600' : 'text-slate-400'}"><i data-lucide="clipboard-list" class="w-3.5 h-3.5"></i> Solicitudes</button>
                            </div>
                            <button onclick="window.handleAdminLogout()" class="text-red-400 px-4 py-2 hover:bg-red-50 rounded-xl transition-all"><i data-lucide="log-out" class="w-6 h-6"></i></button>
                        </div>
                    </header>

                    ${state.adminTab === 'inventory' ? `
                        <div class="space-y-6">
                            <div class="flex justify-between items-center px-4">
                                <h2 class="text-2xl font-black text-slate-800 tracking-tight flex items-center gap-3"><i data-lucide="layout-dashboard" class="text-indigo-500 w-7 h-7"></i> Catálogo Maestro</h2>
                                <button onclick="window.openModal()" class="bg-indigo-600 text-white px-7 py-3 rounded-2xl font-black hover:bg-indigo-700 shadow-xl shadow-indigo-100 transition-all active:scale-95"><i data-lucide="plus" class="w-5 h-5"></i> Nuevo Insumo</button>
                            </div>
                            <div class="bg-white rounded-[3rem] border border-slate-200 shadow-sm overflow-hidden overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead class="text-slate-400 font-black border-b border-slate-100 bg-white text-[10px] uppercase tracking-widest">
                                        <tr><th class="px-10 py-7">Producto</th><th class="px-10 py-7">Categoría</th><th class="px-10 py-7 text-center">Stock Actual</th><th class="px-10 py-7 text-right">Acciones</th></tr>
                                    </thead>
                                    <tbody class="divide-y divide-slate-50">
                                        ${state.inventory.map(item => `
                                            <tr class="hover:bg-slate-50/70 transition-colors">
                                                <td class="px-10 py-7 font-black text-slate-800 text-lg">${item.name}</td>
                                                <td class="px-10 py-7 text-slate-400 font-black uppercase text-[10px]">${item.category}</td>
                                                <td class="px-10 py-7 text-center">
                                                    <div class="flex flex-col items-center">
                                                        <span class="font-mono font-black text-2xl ${item.stock < 10 ? 'text-red-500' : 'text-slate-900'}">${item.stock}</span>
                                                        <span class="text-[10px] opacity-40 uppercase font-black">${item.unit}</span>
                                                    </div>
                                                </td>
                                                <td class="px-10 py-7 text-right">
                                                    <div class="flex justify-end gap-2">
                                                        <button onclick='window.openModal(${JSON.stringify(item)})' class="p-4 text-indigo-600 hover:bg-indigo-50 rounded-2xl border border-slate-100 shadow-sm"><i data-lucide="edit-3" class="w-5 h-5"></i></button>
                                                        <button onclick="window.handleDeleteProduct('${item.id}')" class="p-4 text-red-300 hover:text-red-500 hover:bg-red-50 rounded-2xl border border-slate-100 shadow-sm"><i data-lucide="trash-2" class="w-5 h-5"></i></button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    ` : `
                        <div class="space-y-6">
                            <h2 class="text-2xl font-black text-slate-800 px-4">Cola de Despacho</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                ${state.requests.length === 0 ? '<div class="col-span-full py-24 text-center text-slate-300 italic">No hay solicitudes</div>' : state.requests.map(req => `
                                    <div class="bg-white p-8 rounded-[3rem] border shadow-sm transition-all ${req.status === 'Entregado' ? 'border-green-100 opacity-60' : 'border-slate-200 border-l-[16px] border-l-orange-400'}">
                                        <div class="flex justify-between items-start mb-8">
                                            <div><h4 class="font-black text-slate-800 text-xl">${req.employee}</h4><p class="text-[10px] text-slate-400 font-black uppercase mt-3 tracking-widest">${req.department}</p></div>
                                            <span class="text-[9px] font-black px-4 py-2 rounded-full uppercase tracking-widest ${req.status === 'Entregado' ? 'bg-green-100 text-green-700' : 'bg-orange-100 text-orange-700'}">${req.status}</span>
                                        </div>
                                        <div class="bg-slate-50 p-6 rounded-[2rem] mb-8 space-y-3 border border-slate-100">
                                            ${req.items.map(i => `<div class="flex justify-between text-sm font-bold"><span class="text-slate-600">${i.name}</span><span class="bg-white px-2.5 py-0.5 rounded-lg text-xs">x${i.quantity}</span></div>`).join('')}
                                        </div>
                                        <div class="flex items-center justify-between mt-6">
                                            <span class="text-[9px] text-slate-300 font-black uppercase tracking-tighter">${req.date}</span>
                                            ${req.status === 'Pendiente' ? `<button onclick="window.updateRequestStatus('${req.id}', 'Entregado')" class="bg-green-600 text-white px-6 py-2.5 rounded-2xl font-black hover:bg-green-700 text-xs shadow-lg shadow-green-100 transition-all active:scale-95"><i data-lucide="check-circle" class="w-4 h-4 inline mr-1"></i> Entregar</button>` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `}
                </div>
            `;
        };

        // --- Inicialización y Exposición Global ---
        window.onload = () => {
            // Vincular funciones globales
            window.addToCart = addToCart;
            window.updateCartQuantity = updateCartQuantity;
            window.submitRequest = submitRequest;
            window.handleSaveProduct = handleSaveProduct;
            window.handleDeleteProduct = handleDeleteProduct;
            window.updateRequestStatus = updateRequestStatus;
            window.openModal = openModal;
            window.closeModal = closeModal;
            window.setAdminTab = (tab) => { state.adminTab = tab; render(); };
            window.handleAdminLogout = handleAdminLogout;
            window.handleAdminLogin = (e) => {
                e.preventDefault();
                if (document.getElementById('adminPwd').value === ADMIN_PASSWORD) {
                    state.isAdminAuthenticated = true;
                    notify("Acceso concedido");
                } else {
                    notify("Contraseña incorrecta", "error");
                }
                render();
            };
            window.setView = (v) => { state.view = v; render(); };

            // Auth Rule 3
            onAuthStateChanged(auth, (currentUser) => {
                state.user = currentUser;
                if (!currentUser) {
                    signInAnonymously(auth);
                } else {
                    // Listeners Rule 1 & 2
                    onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'inventory'), (snap) => {
                        state.inventory = snap.docs.map(d => ({ id: d.id, ...d.data() }));
                        state.isLoading = false;
                        render();
                    });
                    onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'requests'), (snap) => {
                        state.requests = snap.docs.map(d => ({ id: d.id, ...d.data() })).sort((a,b) => b.timestamp - a.timestamp);
                        render();
                    });
                }
            });
        };

        function handleAdminLogout() {
            state.isAdminAuthenticated = false;
            state.view = 'employee';
            render();
            notify("Sesión cerrada");
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 pb-20">

    <!-- Navegación -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-40">
        <div class="max-w-6xl mx-auto px-4 h-16 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="bg-blue-600 p-2 rounded-xl shadow-lg shadow-blue-100">
                    <i data-lucide="package" class="text-white w-5 h-5"></i>
                </div>
                <span class="font-black text-xl text-slate-800 tracking-tight">Ofi<span class="text-blue-600">Stock</span></span>
            </div>
            <div class="flex bg-slate-100 p-1 rounded-2xl border border-slate-200">
                <button onclick="window.setView('employee')" id="nav-emp" class="px-5 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all">Empleado</button>
                <button onclick="window.setView('admin')" id="nav-adm" class="px-5 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all">Admin</button>
            </div>
        </div>
    </nav>

    <!-- Contenido Principal -->
    <main id="app-content" class="max-w-6xl mx-auto px-4 py-8">
        <!-- Cargado vía JS -->
    </main>

    <!-- Modal Admin -->
    <div id="modal" class="hidden fixed inset-0 bg-slate-900/70 backdrop-blur-xl z-50 flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-md rounded-[3.5rem] shadow-2xl overflow-hidden">
            <form id="productForm" class="p-10 space-y-8">
                <div class="flex justify-between items-center">
                    <h2 id="modalTitle" class="text-3xl font-black text-slate-800 tracking-tighter">Insumo</h2>
                    <button type="button" onclick="window.closeModal()" class="text-slate-300 hover:text-slate-900 transition-colors p-3 bg-slate-50 rounded-2xl"><i data-lucide="x" class="w-8 h-8"></i></button>
                </div>
                <div class="space-y-6">
                    <div class="space-y-2">
                        <label class="text-[10px] font-black uppercase text-slate-400 ml-3 tracking-widest">Nombre Insumo</label>
                        <input name="name" required class="w-full p-5 bg-slate-50 border border-slate-200 rounded-3xl outline-none focus:ring-4 focus:ring-indigo-50 font-bold text-lg" />
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-black uppercase text-slate-400 ml-3 tracking-widest">Categoría</label>
                        <input name="category" required class="w-full p-5 bg-slate-50 border border-slate-200 rounded-3xl outline-none focus:ring-4 focus:ring-indigo-50 font-bold" />
                    </div>
                    <div class="flex gap-4">
                        <div class="flex-1 space-y-2">
                            <label class="text-[10px] font-black uppercase text-slate-400 ml-3 tracking-widest">Stock</label>
                            <input name="stock" type="number" required class="w-full p-5 bg-slate-50 border border-slate-200 rounded-3xl outline-none focus:ring-4 focus:ring-indigo-50 font-black text-xl text-center" />
                        </div>
                        <div class="flex-1 space-y-2">
                            <label class="text-[10px] font-black uppercase text-slate-400 ml-3 tracking-widest">Unidad</label>
                            <input name="unit" required class="w-full p-5 bg-slate-50 border border-slate-200 rounded-3xl outline-none focus:ring-4 focus:ring-indigo-50 font-bold" />
                        </div>
                    </div>
                </div>
                <button type="submit" class="w-full bg-indigo-600 text-white py-6 rounded-[2.5rem] font-black hover:bg-indigo-700 shadow-2xl shadow-indigo-100 transition-all text-xl">Guardar en Cloud</button>
            </form>
        </div>
    </div>

    <!-- Notificaciones -->
    <div id="notification" class="hidden"></div>

</body>
</html>
